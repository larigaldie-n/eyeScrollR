<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="eyeScrollR">
<title>Using eyeScrollR with fixed areas • eyeScrollR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using eyeScrollR with fixed areas">
<meta property="og:description" content="eyeScrollR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">eyeScrollR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/eyeScrollR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/fixed_areas.html">Using eyeScrollR with fixed areas</a>
    <a class="dropdown-item" href="../articles/limitations.html">Limitations</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Using eyeScrollR with fixed areas</h1>
            
      
      
      <div class="d-none name"><code>fixed_areas.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-fixed_areas-list">The fixed_areas list<a class="anchor" aria-label="anchor" href="#the-fixed_areas-list"></a>
</h2>
<p>Today, many websites have areas that do not move with the rest of the
scrolled areas. Typically those are navigation menus at the very top
and/or on the right, and footers. The problem with those is that even if
the page has been scrolled to the very bottom, gazing at the top menu
means that, on the full webpage image, the gaze has suddenly moved from
the very bottom of the page to the very top without scrolling back.</p>
<p>For instance, consider this website (which you can find <a href="../test_page.html" title="test page">here</a>):</p>
<p><img src="fixed_full.png" width="100%"></p>
<p>For the moment, let us just ignore the fact that the top area ends up
shrinking at some point; we will come back to this later.</p>
<p>The areas at the top and on the right are all fixed, so if you scroll
down a bit, only some of the content is actually moving on the screen.
The full webpage image may look like this (although the result may
slightly differ depending on the plugin you are using to extract the
image):</p>
<p><img src="fixed_website.png" width="100%"></p>
<p>What we really want is to instruct the program that no matter how far
down we scrolled, there are areas on the screen that will always be
mapped to the same area on the webpage image (while the rest may move
around).</p>
<p>In the below example, we show how slightly scrolling down (while
gazing at the same content) should only make the program apply a scroll
correction to coordinates on the scrollable content (green dot), while
redirecting the fixed areas to other fixed areas across the webpage
image (red, blue, and yellow dots). As such, fixation on the top right
image after a few scrolls should result in the exact same heatmap as on
the top left image, before any scroll was made.</p>
<p><img src="fixed_example_full.png" width="100%"></p>
<p>The way to achieve this in eyeScrollR is, as the rectangles in the
above image suggested, to map a fixed relationship between areas from
the screen to areas on the image. Gaze and fixation coordinates in the
red rectangle on the screen should always be redirected to the red
rectangle on the image, the blue area on the screen to the blue
rectangle on the image, and the yellow area to the yellow rectangle on
the image.</p>
<p>In a similar way as the manual calibration procedure, just open a
screenshot of your screen while browsing the website, and get the
coordinates of the top left and bottom right pixels of any fixed area
you want to map to your full page image. Once this is done, you can do
the same with the destination coordinates on the full page image, as in
the following:</p>
<div class="figure">
<img src="fixed_areas_mapping.png" alt="Left: the screenshot image; Right: the full webpage image" width="100%"><p class="caption">
Left: the screenshot image; Right: the full webpage image
</p>
</div>
<p>Repeat the process for every fixed area you may encounter. All that
is left to do now is to actually pass these coordinates in a form that
the package can recognize. In order to do that, you just need to create
pairs of coordinate vectors and pass these to the
<em>fixed_areas_bundle</em> function as vectors with the form
<em>c(top_left_x, top_left_y, bottom_right_x, bottom_right_y)</em>. For
example, we measured the following values:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># These two are the top header</span></span>
<span><span class="va">top_fixed_area_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">89</span>, <span class="fl">1919</span>, <span class="fl">276</span><span class="op">)</span></span>
<span><span class="va">top_fixed_area_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1919</span>, <span class="fl">187</span><span class="op">)</span></span>
<span><span class="co"># These two are the yellowish area on the right</span></span>
<span><span class="va">right_fixed_area_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">277</span>, <span class="fl">1919</span>, <span class="fl">936</span><span class="op">)</span></span>
<span><span class="va">right_fixed_area_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">188</span>, <span class="fl">1919</span>, <span class="fl">847</span><span class="op">)</span></span>
<span><span class="co"># These two are the bottom right area</span></span>
<span><span class="va">bottom_right_fixed_area_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">937</span>, <span class="fl">1919</span>, <span class="fl">1029</span><span class="op">)</span></span>
<span><span class="va">bottom_right_fixed_area_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">4284</span>, <span class="fl">1919</span>, <span class="fl">4376</span><span class="op">)</span></span>
<span></span>
<span><span class="va">area_bundle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fixed_areas_bundle.html">fixed_areas_bundle</a></span><span class="op">(</span><span class="va">top_fixed_area_screen</span>,</span>
<span>                                  <span class="va">top_fixed_area_image</span>,</span>
<span>                                  <span class="va">right_fixed_area_screen</span>,</span>
<span>                                  <span class="va">right_fixed_area_image</span>,</span>
<span>                                  <span class="va">bottom_right_fixed_area_screen</span>,</span>
<span>                                  <span class="va">bottom_right_fixed_area_image</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fixed_areas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">area_bundle</span><span class="op">)</span></span></code></pre></div>
<p>It is imperative that you pass the arguments in ordered pairs of
screen-to-image mappings, and that you put the result in a list (we will
come to the reason why in the next section). Your rectangle pairs MUST
also have the exact same dimensions.</p>
<p>Once this is done, provided that you already did the calibration
procedure, simply pass the <em>fixed_areas</em> argument to the
<em>eye_scroll_correct</em> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corrected_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eye_scroll_correct.html">eye_scroll_correct</a></span><span class="op">(</span>eyes_data <span class="op">=</span> <span class="va">test_data</span>,</span>
<span>                                     timestamp_start <span class="op">=</span> <span class="fl">3577</span>,</span>
<span>                                     timestamp_stop <span class="op">=</span> <span class="fl">30864</span>,</span>
<span>                                     image_width <span class="op">=</span> <span class="fl">1920</span>,</span>
<span>                                     image_height <span class="op">=</span> <span class="fl">4377</span>,</span>
<span>                                     calibration <span class="op">=</span> <span class="va">calibration</span>,</span>
<span>                                     fixed_areas <span class="op">=</span> <span class="va">fixed_areas</span><span class="op">)</span></span></code></pre></div>
<p>This should be enough for simple situations with fixed areas that
never change.</p>
</div>
<div class="section level2">
<h2 id="the-rules-list">The rules list<a class="anchor" aria-label="anchor" href="#the-rules-list"></a>
</h2>
<p>The most complicated use-case scenario that eyeScrollR can handle is
when those fixed areas have a somewhat dynamic behaviour. The most
common example is a top menu bar that shrinks (or even disappears!) when
a certain number of pixels have been scrolled down. In these situations,
if a screen-to-image direct mapping is still meaningful across the
different possible states of the webpage, it is possible to create
several bundles of fixed areas mappings and create rules to instruct the
package which bundle should be used at what time.</p>
<p>For instance, you could create a bundle of mappings to be used when a
user has not scrolled down yet and another one to be used only once they
have.</p>
<p>The <a href="../test_page.html" title="test page">example</a> we
provide is a situation in which the screen-to-image mapping is still
meaningful. Indeed, although the top area shrinks, what remains can
still be perfectly mapped to the full page image, as the whole area of
the shrunken header still has perfect correspondance (as so the bottom
right area):</p>
<div class="figure">
<img src="rules_ex.png" alt="Top: before the shrinking; Bottom: after the shrinking" width="100%"><p class="caption">
Top: before the shrinking; Bottom: after the shrinking
</p>
</div>
<p>The right area is a critical-case scenario where the researcher will
have to make a decision and may solve things creatively. Indeed, the
size of this area once the header has shrunk is now larger than the one
we got on the captured full page image. Therefore, we can no longer make
a perfect mapping of the two areas. In some cases, this might mean that
it is impossible to map everything in a single image, and you might
consider splitting your participant’s data to have several images.</p>
<p>However, in this particular case, we can choose to ignore this, or
even do some manual editing to the full page image to expand the area!
Indeed, the empty area below the one we are interested in is otherwise
never reachable to an observer: there will always be something on the
right of the page, and the long band of white is only an artifact of the
screenshot plugin. As such, it is possible to just make the following
mapping:</p>
<p><img src="rules_ex_right.png" width="100%"></p>
<p>In this situation, the bottom-right coordinates of the fixed area on
the full page image can be calculated by making sure that the two areas
(the one on the screen and the one on the image) have the exact same
size.</p>
<p>In our case, we ended up with the following measures:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># These two are the top header</span></span>
<span><span class="va">top_fixed_area_bis_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">89</span>, <span class="fl">1919</span>, <span class="fl">182</span><span class="op">)</span></span>
<span><span class="va">top_fixed_area_bis_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1919</span>, <span class="fl">93</span><span class="op">)</span></span>
<span><span class="co"># These two are the yellowish area on the right</span></span>
<span><span class="va">right_fixed_area_bis_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">183</span>, <span class="fl">1919</span>, <span class="fl">936</span><span class="op">)</span></span>
<span><span class="va">right_fixed_area_bis_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">188</span>, <span class="fl">1919</span>, <span class="fl">941</span><span class="op">)</span></span>
<span><span class="co"># These two are the bottom right area</span></span>
<span><span class="va">bottom_right_fixed_area_bis_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">937</span>, <span class="fl">1919</span>, <span class="fl">1029</span><span class="op">)</span></span>
<span><span class="va">bottom_right_fixed_area_bis_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">4284</span>, <span class="fl">1919</span>, <span class="fl">4376</span><span class="op">)</span></span>
<span></span>
<span><span class="va">area_bundle_bis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fixed_areas_bundle.html">fixed_areas_bundle</a></span><span class="op">(</span><span class="va">top_fixed_area_bis_screen</span>,</span>
<span>                                  <span class="va">top_fixed_area_bis_image</span>,</span>
<span>                                  <span class="va">right_fixed_area_bis_screen</span>,</span>
<span>                                  <span class="va">right_fixed_area_bis_image</span>,</span>
<span>                                  <span class="va">bottom_right_fixed_area_bis_screen</span>,</span>
<span>                                  <span class="va">bottom_right_fixed_area_bis_image</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fixed_areas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">area_bundle</span>, <span class="va">area_bundle_bis</span><span class="op">)</span></span></code></pre></div>
<p>This time, the <em>fixed_areas</em> list comprises two bundles of
mappings: the one that should be used <strong>before</strong> the user
has scrolled down enough to shrink the top header, and the one that
should be used <strong>after</strong>.</p>
<p>The only thing left to do is to create a <em>rules</em> list, so that
the package can know when to use which bundle.</p>
<p>A rule is a function that checks, at each line of the .csv file, if
conditions to use a specific bundle are met or not. In our case here, we
would need a first rule asking if the user has not scrolled down a
sufficient amount of pixels to shrink the header, in which case the
first bundle of fixed areas should be used, and not otherwise. We would
also require a second rule, asking the exact opposite for the second
bundle. Finding the conditions that change the fixed areas may require
some experimentation in the field. In our website example, the header
just retracts when more than 1000 pixels have been scrolled down, and
expands again in the other case.</p>
<p>The <em>eye_scroll_correct</em> function calls all rule functions at
every line of the .csv file and pass them several arguments to work on.
Working on complex sets of rules is possible if you have the programming
knowledge to do so. In any case, it will require you to write your own
functions. The scenario presented here is easy enough to be modified
whatever your level of expertise in R is and should be appropriate for
the vast majority of the use-case scenarios.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rule_scrolled_up</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">data_line</span>, <span class="va">array_fixed_areas</span>, <span class="va">flag</span>, <span class="va">scroll</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">scroll</span> <span class="op">&lt;=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span>    <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">else</span></span>
<span>    <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">rule_scrolled_down</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">data_line</span>, <span class="va">array_fixed_areas</span>, <span class="va">flag</span>, <span class="va">scroll</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">scroll</span> <span class="op">&gt;</span> <span class="fl">1000</span><span class="op">)</span></span>
<span>    <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">else</span></span>
<span>    <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">rules</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">rule_scrolled_up</span>, <span class="va">rule_scrolled_down</span><span class="op">)</span></span></code></pre></div>
<p>The order of these rules must be the same as the order of the fixed
areas bundles. In our case, the <em>rule_scrolled_up</em> rule will
therefore make sure that the first bundle of fixed areas will be used
when less than 1000 pixels have been scrolled down and no longer be used
should it not be the case. Similarly, the <em>rule_scrolled_down</em>
rule will be associated with the second bundle of fixed areas. You can
copy and paste these functions and simply change the number
<em>1000</em> in each of them to fit your needs if you are in a similar
case.</p>
<p>If this all feels a bit overwhelming, don’t worry: we’ve got you
covered. Instead of writing everything by hand, you can just use the
bundle creator gadget by running the following code:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bundles_gadget.html">bundles_gadget</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This gadget simplifies the process by letting you focus on
<em>what</em> you are doing instead of <em>how</em>. You can add/remove
fixed areas bundles with a simple click, fill in the fixed areas
coordinates, and select which (common) rule you need for each
bundle:</p>
<p><img src="gadget.png" width="100%"></p>
<p>This will output some code that you can copy &amp; paste, and the
only thing left you have to do is modify the rules to suit your needs.
Just don’t forget to click “done” once you are finished!</p>
<p>You can then just pass the list of fixed areas and the list of rules
to the <em>eye_scroll_correct</em> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corrected_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eye_scroll_correct.html">eye_scroll_correct</a></span><span class="op">(</span>eyes_data <span class="op">=</span> <span class="va">test_data</span>,</span>
<span>                                     timestamp_start <span class="op">=</span> <span class="fl">3577</span>,</span>
<span>                                     timestamp_stop <span class="op">=</span> <span class="fl">30864</span>,</span>
<span>                                     image_width <span class="op">=</span> <span class="fl">1920</span>,</span>
<span>                                     image_height <span class="op">=</span> <span class="fl">4377</span>,</span>
<span>                                     calibration <span class="op">=</span> <span class="va">calibration</span>,</span>
<span>                                     fixed_areas <span class="op">=</span> <span class="va">fixed_areas</span>,</span>
<span>                                     rules <span class="op">=</span> <span class="va">rules</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-complete-commented-code-for-our-example">A complete, commented code for our example<a class="anchor" aria-label="anchor" href="#a-complete-commented-code-for-our-example"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://larigaldie-n.github.io/eyeScrollR/">eyeScrollR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.rforge.net/png/" class="external-link">png</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">################################################################################</span></span>
<span><span class="co"># General settings</span></span>
<span><span class="co"># Same for every data file for a given webpage</span></span>
<span><span class="co"># (aka "do this only once per webpage, then stop thinking about it")</span></span>
<span><span class="co">################################################################################</span></span>
<span></span>
<span><span class="co">### Automatic calibration</span></span>
<span><span class="va">calibration_image</span> <span class="op">&lt;-</span> <span class="fu">readPNG</span><span class="op">(</span><span class="st">"calibration_chrome.png"</span><span class="op">)</span></span>
<span><span class="va">calibration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scroll_calibration_auto.html">scroll_calibration_auto</a></span><span class="op">(</span><span class="va">calibration_image</span>, <span class="fl">125</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Fixed area bundles</span></span>
<span><span class="co">## First bundle: when not scrolled down yet</span></span>
<span><span class="co"># These two are the top header</span></span>
<span><span class="va">top_fixed_area_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">89</span>, <span class="fl">1919</span>, <span class="fl">276</span><span class="op">)</span></span>
<span><span class="va">top_fixed_area_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1919</span>, <span class="fl">187</span><span class="op">)</span></span>
<span><span class="co"># These two are the yellowish area on the right</span></span>
<span><span class="va">right_fixed_area_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">277</span>, <span class="fl">1919</span>, <span class="fl">936</span><span class="op">)</span></span>
<span><span class="va">right_fixed_area_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">188</span>, <span class="fl">1919</span>, <span class="fl">847</span><span class="op">)</span></span>
<span><span class="co"># These two are the bottom right area</span></span>
<span><span class="va">bottom_right_fixed_area_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">937</span>, <span class="fl">1919</span>, <span class="fl">1029</span><span class="op">)</span></span>
<span><span class="va">bottom_right_fixed_area_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">4284</span>, <span class="fl">1919</span>, <span class="fl">4376</span><span class="op">)</span></span>
<span></span>
<span><span class="va">area_bundle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fixed_areas_bundle.html">fixed_areas_bundle</a></span><span class="op">(</span><span class="va">top_fixed_area_screen</span>,</span>
<span>                                  <span class="va">top_fixed_area_image</span>,</span>
<span>                                  <span class="va">right_fixed_area_screen</span>,</span>
<span>                                  <span class="va">right_fixed_area_image</span>,</span>
<span>                                  <span class="va">bottom_right_fixed_area_screen</span>,</span>
<span>                                  <span class="va">bottom_right_fixed_area_image</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Second bundle: when scrolled down enough</span></span>
<span><span class="co"># These two are the top header</span></span>
<span><span class="va">top_fixed_area_bis_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">89</span>, <span class="fl">1919</span>, <span class="fl">182</span><span class="op">)</span></span>
<span><span class="va">top_fixed_area_bis_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1919</span>, <span class="fl">93</span><span class="op">)</span></span>
<span><span class="co"># These two are the yellowish area on the right</span></span>
<span><span class="va">right_fixed_area_bis_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">183</span>, <span class="fl">1919</span>, <span class="fl">936</span><span class="op">)</span></span>
<span><span class="va">right_fixed_area_bis_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">188</span>, <span class="fl">1919</span>, <span class="fl">941</span><span class="op">)</span></span>
<span><span class="co"># These two are the bottom right area</span></span>
<span><span class="va">bottom_right_fixed_area_bis_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">937</span>, <span class="fl">1919</span>, <span class="fl">1029</span><span class="op">)</span></span>
<span><span class="va">bottom_right_fixed_area_bis_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1632</span>, <span class="fl">4284</span>, <span class="fl">1919</span>, <span class="fl">4376</span><span class="op">)</span></span>
<span></span>
<span><span class="va">area_bundle_bis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fixed_areas_bundle.html">fixed_areas_bundle</a></span><span class="op">(</span><span class="va">top_fixed_area_bis_screen</span>,</span>
<span>                                      <span class="va">top_fixed_area_bis_image</span>,</span>
<span>                                      <span class="va">right_fixed_area_bis_screen</span>,</span>
<span>                                      <span class="va">right_fixed_area_bis_image</span>,</span>
<span>                                      <span class="va">bottom_right_fixed_area_bis_screen</span>,</span>
<span>                                      <span class="va">bottom_right_fixed_area_bis_image</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Now, the rule functions</span></span>
<span><span class="co"># The first one, when we are below 1000 pixels scrolled</span></span>
<span><span class="va">rule_scrolled_up</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">data_line</span>, <span class="va">array_fixed_areas</span>, <span class="va">flag</span>, <span class="va">scroll</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">scroll</span> <span class="op">&lt;=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">else</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># The second one, when we are above 1000 pixels scrolled</span></span>
<span><span class="va">rule_scrolled_down</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">data_line</span>, <span class="va">array_fixed_areas</span>, <span class="va">flag</span>, <span class="va">scroll</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">scroll</span> <span class="op">&gt;</span> <span class="fl">1000</span><span class="op">)</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">else</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create the fixed_areas list with both bundles, and associate rules by putting</span></span>
<span><span class="co"># them in the same order</span></span>
<span><span class="va">fixed_areas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">area_bundle</span>, <span class="va">area_bundle_bis</span><span class="op">)</span></span>
<span><span class="va">rules</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">rule_scrolled_up</span>, <span class="va">rule_scrolled_down</span><span class="op">)</span></span>
<span></span>
<span><span class="co">################################################################################</span></span>
<span><span class="co"># Participant-specific code</span></span>
<span><span class="co">################################################################################</span></span>
<span><span class="co"># Read data, and make sure labels are alright</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"fixed_areas.csv"</span>, comment <span class="op">=</span> <span class="st">"#"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply the scroll corrections</span></span>
<span><span class="va">corrected_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eye_scroll_correct.html">eye_scroll_correct</a></span><span class="op">(</span>eyes_data <span class="op">=</span> <span class="va">test_data</span>,</span>
<span>                                     timestamp_start <span class="op">=</span> <span class="fl">8504</span>,</span>
<span>                                     timestamp_stop <span class="op">=</span> <span class="fl">70478</span>,</span>
<span>                                     image_width <span class="op">=</span> <span class="fl">1920</span>,</span>
<span>                                     image_height <span class="op">=</span> <span class="fl">4377</span>,</span>
<span>                                     calibration <span class="op">=</span> <span class="va">calibration</span>,</span>
<span>                                     fixed_areas <span class="op">=</span> <span class="va">fixed_areas</span>,</span>
<span>                                     rules <span class="op">=</span> <span class="va">rules</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the full page image</span></span>
<span><span class="va">heatmap_image</span> <span class="op">&lt;-</span> <span class="fu">readPNG</span><span class="op">(</span><span class="st">"fixed_website.png"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output the heatmap</span></span>
<span><span class="fu"><a href="../reference/generate_heatmap.html">generate_heatmap</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">corrected_data</span>, heatmap_image <span class="op">=</span> <span class="va">heatmap_image</span><span class="op">)</span></span></code></pre></div>
<p><img src="final_example.png" width="100%"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Nathanael Larigaldie, Anna Dreneva, Jacob Orquin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
